<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

	<title>Eustace W. Thrimbletrimmer Editing Suite</title>
  
	<script src="scripts/jquery-2.1.3.min.js"></script>
	<script src="scripts/jquery-ui-1.11.4/jquery-ui.js"></script>
	<script src="scripts/wubPlayerControls.js"></script>
	<script src="scripts/wubEditorControls.js"></script>
	<link rel="stylesheet" href="scripts/jquery-ui-1.11.4/jquery-ui.css">
	<link rel="stylesheet" href="styles/wubPlayerControls.css">
	<link rel="stylesheet" href="styles/wubEditorControls.css">
</head>
<body>
	<div id="EditorContent">	
	</div>
	<script type="text/javascript">
		var path = window.location.protocol + '//' + window.location.hostname;
		var thumbnailInfo = {};
		
		var getExtraData = function() {
			var extraData = [thumbnailInfo];
			return extraData;
		}
		
		var CallForWubs = function(Callback) {
			if(window.location.search.match(/video=(.*?)(&|$)/i)) {
				var videoID = window.location.search.match(/video=(.*?)(&|$)/i)[1];
				$.get('/getwubs/'+videoID,function(data) { Callback(data); },'json');
			}
		};
		
		var InsertVideo = function(wubs) {
			$('#EditorContent').append('<video id="wubPlayer" width="'+wubs.width+'" height="'+wubs.height+'" style="padding-top:2px;" vidID='+wubs.vidID+'>' +
											'<source src="'+wubs.src+'" type="'+wubs.type+'" />' +
											'Your browser does not support HTML5 video.' +
										'</video>');
			$('#wubPlayer').wVideo({startOffset:10});
			$('#wubPlayer').wEditor({submitLoc:'/setwubs', startOffset:10, endOffset:10, vidID:wubs.vidID, title:wubs.title, description:wubs.description, extraMetadata:getExtraData});
			//Add Thumbnail selection/editing functionality.
			$('#SubmitButton').before('<input type="button" id="SetThumbnail" value="Set Thumbnail"/>');
			$('#SetThumbnail').click(function() {
				var thumbnailEditor = window.open('ThumbnailEditor.html','Thumbnail Editor','width=800, height=600, scrollbars=yes');
				thumbnailEditor.video_source = wubs.src;
				thumbnailEditor.video_type = wubs.type;
				thumbnailEditor.video_width = wubs.width;
				thumbnailEditor.video_height = wubs.height;
				thumbnailEditor.video_framerate = wubs.framerate;
			});
		};
		
		
		var PageSetup = function() {
			CallForWubs(InsertVideo);
		};
		
		PageSetup();
	</script>
</body>
</html>
